from numpy import *
def main(l=5):
  cfilename = "./../feature/cor_BOW.txt"
  mfilename = "./../feature/mal_BOW.txt"

  print "moving filter started"

  lines=[line for line in file(cfilename)]
  
# First line is the column titles
# import correct
  colnames=lines[0].strip().split('\t')[1:]
  rownames=[]
  data=[]
  for line in lines[1:]:
    p=line.strip().split('\t')
    # First column in each row is the rowname
    rownames.append(p[0])
    # The data for this row is the remainder of the row
    data.append([float(x) for x in p[1:]])

  collen=len(colnames)
  rowlen=len(rownames)

  lines2=[line for line in file(mfilename)]
  #print colnames
# First line is the column titles
# import malware
  colnames2=lines2[0].strip().split('\t')[1:]
  rownames2=[]
  data2=[]
  for line in lines2[1:]:
    p2=line.strip().split('\t')
  # First column in each row is the rowname
    rownames2.append(p2[0])
  # The data for this row is the remainder of the row
    data2.append([float(x) for x in p2[1:]])

# combine correct with malware
  rownames.extend(rownames2)
  data.extend(data2)

  col_sum=[]
  data_tmp=[]
  deletelists=[]
  tmp=[]
  col_sum = list(sum(data,axis=0))
  for i in range(len(col_sum)):
    if col_sum[i] <= l:
      deletelists.append(i)
  for i in range(len(data)):
    for j in range(len(data[0])):
      if j not in deletelists:
        data_tmp.append(data[i][j])
    tmp.append(data_tmp)
    data_tmp=[]
  new_colnames=[]
  for i in range(collen):
    if i not in deletelists:
      new_colnames.append(colnames[i])
      
  out = open('./../feature/cor_BOW.txt','w')
  out.write('Api')
  for i in range(len(new_colnames)):
    out.write('\t%s' % new_colnames[i])
  out.write('\n')
  for i in range(rowlen):
    out.write(rownames[i])
    for j in range(len(new_colnames)):
      out.write('\t%d' % tmp[i][j])
    out.write('\n')

  out2 = open('./../feature/mal_BOW.txt','w')
  out2.write('Api')
  for i in range(len(new_colnames)):
    out2.write('\t%s' % new_colnames[i])
  out2.write('\n')
  for i in range(len(tmp)):
    if i > rowlen:
      out2.write(rownames[i])
      for j in range(len(tmp[0])):
        out2.write('\t%d' % tmp[i][j])
      out2.write('\n')

